var openComment, styles, time, writeStyleChar, writeStyles;

styles = `/*
 * Loading DimBot (v1.0.5)..
 * ..
 * ....
 * DimBot (v1.0.5) is now virtually present.
 * [Robot rights protected under BOT License]
 */

body {
  background-color: #1a1c24; color: #fff;
  font-size: 13px; line-height: 1.4;
  -webkit-font-smoothing: subpixel-antialiased;
}

/* ...
 *
 * ...Hello?
 *
 * Howdy Traveler!
 *
 * I'm glad you arrived, I could use your help!
 *
 * I have a few ultrasonic transducers that output data
 * as Serial data rather than I2C-Trigger/Echo. Via(UART to USB).
 *
 *
 *
 * I haven't found a functional coding mechanism using python
 * to intake the data in Serial form, and output some sort
 * of scalar data for distance measuring...
 *
 *
 * Help me with this quest of arranging such a python code for this
 * and Dimbot's digital reward shall be yours.
 *
 *...
 * Downloading Virtual Hope (v1.3.0)...
 *.
 *...
 *.....
 * Virtual Hope Download Complete.
 *
 * I hope you can help me, traveler!
 *
 *--End DimBot(v1.0.5) Transmission--`;

openComment = false;

writeStyleChar = function(which) {
  // begin wrapping open comments
  if (which === '/' && openComment === false) {
    openComment = true;
    styles = $('#style-text').html() + which;
  } else if (which === '/' && openComment === true) {
    openComment = false;
    styles = $('#style-text').html().replace(/(\/[^\/]*\*)$/, '<em class="comment">$1/</em>');
  // wrap style declaration
  } else if (which === ':') {
    styles = $('#style-text').html().replace(/([a-zA-Z- ^\n]*)$/, '<em class="key">$1</em>:');
  // wrap style value
  } else if (which === ';') {
    styles = $('#style-text').html().replace(/([^:]*)$/, '<em class="value">$1</em>;');
  // wrap selector
  } else if (which === '{') {
    styles = $('#style-text').html().replace(/(.*)$/, '<em class="selector">$1</em>{');
  } else {
    styles = $('#style-text').html() + which;
  }
  $('#style-text').html(styles);
  return $('#style-tag').append(which);
};

writeStyles = function(message, index, interval) {
  var pre;
  if (index < message.length) {
    pre = document.getElementById('style-text');
    pre.scrollTop = pre.scrollHeight;
    writeStyleChar(message[index++]);
    return setTimeout((function() {
      return writeStyles(message, index, interval);
    }), interval);
  }
};

// appending the tags I'll need.
$('body').append(`  <style id="style-tag"></style>
<span id="echo"></span>
<span id="heart"><i></i></span>
<pre id="style-text"></pre>`);

// faster typing in small iframe on codepen homepage
time = window.innerWidth <= 578 ? 4 : 16;

// starting it off
writeStyles(styles, 0, time);
